var Dynamics;(function(n){var t;(function(n){var t;(function(t){var i;(function(i){"use strict";function r(t,i){var r,u;if(i===void 0&&(i=!0),r=Xrm.Page.getAttribute(t),r)return r;if(u="The specified attribute could not be found: "+t,i)throw new Error(u);return n.Diagnostics.log.Message(u),null}function f(n){u(n,t.AttributeRequiredLevel.None)}function e(n){u(n,t.AttributeRequiredLevel.Required)}function o(n){u(n,t.AttributeRequiredLevel.Recommended)}function u(t,i){var u,f;if(n.Diagnostics.trace&&n.Diagnostics.printArguments("setRequirementLevel",t,i),Array.isArray(t))for(u=0;u<t.length;u++)f=r(t[u],!1),f&&f.setRequiredLevel(i);else console.warn("Attributes.setRequirementLevel: Invalid argument. An array was expected.")}function s(n,i,u){u===void 0&&(u=!1);var f=r(n,u);f&&f.setRequiredLevel(i?t.AttributeRequiredLevel.Required:t.AttributeRequiredLevel.None)}function h(n,t){var i=n.getOptions();n.controls.forEach(function(n){for(var f,u,r=0;r<i.length;r++)f=i[r],u=parseInt(f.value),(t===undefined||t(u))&&n.removeOption(u)})}function c(n,t){var u,i;return(t===void 0&&(t=!0),u=r(n,t),!u)?null:(i=u.getValue(),!i||!i.length)?null:i[0]}function l(n,t,i,u){var f=r(n,!1),e;f&&(e=u?[{id:u,name:i,entityType:t}]:null,f.setValue(e))}function a(n,t,i){n.controls.forEach(function(n){n.setNotification(t,i)})}function v(n,t){n.controls.forEach(function(n){n.clearNotification(t)})}i.get=r;i.setOptional=f;i.setRequired=e;i.setRecommended=o;i.setRequiredLevel=u;i.setRequiredOrOptional=s;i.hideOptions=h;i.getLookupValue=c;i.setLookupValue=l;i.showNotification=a;i.hideNotification=v})(i=t.Attributes||(t.Attributes={}))})(t=n.Forms||(n.Forms={}))})(t=n.Crm||(n.Crm={}))})(Dynamics||(Dynamics={})),function(n){var t;(function(n){n.publisherPrefix="ts4_"})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){"use strict";var r=function(){function n(){}return n.Error="ERROR",n.Warning="WARNING",n.Information="INFO",n}(),t,i;n.FormNotificationType=r;t=function(){function n(){}return n.Browser="Web",n.Outlook="Outlook",n.Mobile="Mobile",n}();n.ClientType=t;i=function(){function n(){}return n.None="none",n.Required="required",n.Recommended="recommended",n}();n.AttributeRequiredLevel=i})(t=n.Forms||(n.Forms={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(t){var i;(function(i){"use strict";function r(t,i){var r,u;if(i===void 0&&(i=!0),r=Xrm.Page.getControl(t),r)return r;if(u="The specified control could not be found: "+t,i)throw new Error(u);return n.Diagnostics.log.Message(u),null}function e(n,t){t===void 0&&(t=!0);u(n,!0,t)}function o(n,t){t===void 0&&(t=!0);u(n,!1,t)}function u(i,u,f){var e,o,s;if(n.Diagnostics.trace&&n.Diagnostics.printArguments("setDisabled",i,u),Array.isArray(i))for(e=0;e<i.length;e++)f?(o=t.Attributes.get(i[e],!1),o&&o.controls.forEach(function(n){return n.setDisabled(u)})):(s=r(i[e],!1),s&&s.setDisabled(u));else console.warn("Controls.setDisabled: Invalid argument. An array was expected.")}function s(n,t){t===void 0&&(t=!0);t&&f(n,!0,!0)}function h(n,t){t===void 0&&(t=!0);t&&f(n,!1,!0)}function f(i,u,f){var e,o,s;if(n.Diagnostics.printArguments("setDisabled",i,u),Array.isArray(i))for(e=0;e<i.length;e++)f?(o=t.Attributes.get(i[e],!1),o&&o.controls.forEach(function(n){return n.setVisible(u)})):(s=r(i[e],!1),s&&s.setVisible(u));else console.warn("Invalid argument. An array was expected."),console.log(i)}i.get=r;i.disable=e;i.enable=o;i.setDisabled=u;i.show=s;i.hide=h})(i=t.Controls||(t.Controls={}))})(t=n.Forms||(n.Forms={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){"use strict";function i(){try{return Xrm.Page.data.entity.getEntityName()}catch(n){return console.warn(n),"UnknownEntity"}}function r(){for(var t,i=[],n=0;n<arguments.length;n++)i[+n]=arguments[n];for(console.log("Function "+arguments[0]+" called with arguments: {"),t=1;t<arguments.length;t++)console.log(arguments[t]);console.log("}")}n.debug=!0;n.trace=!0;n.log=new t;var t=function(){function t(){}return t.prototype.Error=function(t,r){n.debug;var u=i(),f="{message} - Entity: {entityName} - Name: {errorName} - Message: {errorMessage} - Stack: {stackTrace}"+" - Description: {errorDescription}".replace("{entityName}",u).replace("{message}",t).replace("{errorMessage}",r.message).replace("{errorName}",r.name).replace("{stackTrace}",r.stack||"<NoStackTrace>").replace("{errorDescription}",r.description||"<NoDescription>");console.error(f)},t.prototype.Message=function(n){console.log(n)},t}();n.printArguments=r})(t=n.Diagnostics||(n.Diagnostics={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){"use strict";function i(n,i,r,u,f,e){u===void 0&&(u=800);f===void 0&&(f=600);e===void 0&&(e="yes");var o=t(n,i,r),s="center=yes,width={w},height={h},modal={m}".replace("{m}",e).replace("{h}",f.toString()).replace("{w}",u.toString());window.open(o,n,s,!1)}function t(n,t,i){t===void 0&&(t=Xrm.Page.data.entity.getEntityName());i===void 0&&(i=Xrm.Page.data.entity.getId());return Xrm.Page.context.getClientUrl()+"/cs/dialog/rundialog.aspx?DialogId={dialogId}&EntityName={type}&ObjectId={id}".replace("{type}",t).replace("{id}",i)}n.open=i;n.getUrl=t})(t=n.Dialogs||(n.Dialogs={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){"use strict";function t(n){return n===undefined||n==null?"":n.replace("{","").replace("}","").toLowerCase()}function i(n,i){return!n||!i?!1:t(n)===t(i)}n.parseIdentifier=t;n.identifiersAreEqual=i})(t=n.Core||(n.Core={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t,i;(function(n){n[n.Undefined=0]="Undefined";n[n.Create=1]="Create";n[n.Update=2]="Update";n[n.ReadOnly=3]="ReadOnly";n[n.Disabled=4]="Disabled";n[n.QuickCreate=5]="QuickCreate";n[n.BulkEdit=6]="BulkEdit";n[n.ReadOptimized=11]="ReadOptimized"})(n.FormType||(n.FormType={}));t=n.FormType,function(n){n[n.Unknown=0]="Unknown";n[n.Desktop=1]="Desktop";n[n.Tablet=2]="Tablet";n[n.Phone=3]="Phone"}(n.FormFactor||(n.FormFactor={}));i=n.FormFactor})(t=n.Forms||(n.Forms={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){"use strict";function t(){return Xrm.Page.context.client.getClient()}function u(){return Xrm.Page.ui.getFormType()}function i(){return Xrm.Page.context.client.getFormFactor?Xrm.Page.context.client.getFormFactor():n.FormFactor.Unknown}function r(){var r=i();return r!==n.FormFactor.Unknown?r===n.FormFactor.Desktop:t()!==n.ClientType.Mobile}function f(){return Xrm.Page.data.entity.getIsDirty()}function e(){return r()}n.getClientType=t;n.getFormType=u;n.getFormFactor=i;n.getIsDesktop=r;n.getIsDirty=f;n.supportsIFrames=e})(t=n.Forms||(n.Forms={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(t){var i;(function(t){"use strict";function r(t,i){var r,u;if(i===void 0&&(i=!1),r=Xrm.Page.ui.navigation.items.get(t),r)return r;if(u="The specified navigation item could not be found: "+t,i)throw new Error(u);return n.Diagnostics.log.Message(u),null}function u(n){i(n,!0)}function f(n){i(n,!1)}function i(t,i){var e,u,f;if(n.Diagnostics.trace&&n.Diagnostics.printArguments("Navigation.setVisible",t),Array.isArray(t))for(e=!!i,u=0;u<t.length;u++)(f=r(t[u]),f)&&f.getVisible()!==e&&f.setVisible(e);else console.warn("Navigation.setVisible: Invalid argument. An array was expected.")}t.get=r;t.show=u;t.hide=f;t.setVisible=i})(i=t.Navigation||(t.Navigation={}))})(t=n.Forms||(n.Forms={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){"use strict";function t(n,t,i,r,u){i===void 0&&(i=null);r===void 0&&(r=null);u===void 0&&(u="run");var e=Xrm.Page.context.getClientUrl(),f=e+"/crmreports/viewer/viewer.aspx?action={action}&helpID={name}&id={{id}}".replace("{action}",encodeURIComponent(u)).replace("{name}",encodeURIComponent(n)).replace("{id}",encodeURIComponent(t));return i&&r&&(f+="&context=records&records={{entityId}}&recordstype={entityCode}".replace("{entityId}",i).replace("{entityCode}",r)),f}n.getUrl=t})(t=n.Reports||(n.Reports={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){"use strict";function f(n,t){t===void 0&&(t=window.document);var i=n.map(function(n){return r(n,t)});return jQuery.when(i)}function r(n,i){var u,r;return(console.log("Dynamics.Crm.ScriptManager.loadScript: "+n),u=t[n],!!u)?u:(t[n]=u=jQuery.Deferred(),r=i.createElement("script"),r.defer=!0,r.type="text/javascript",r.src=n,r.addEventListener("load",function(){u.resolveWith(r)}),i.body.appendChild(r),u)}function e(n,t){t===void 0&&(t=window.document);n.forEach(function(n){return u(n,t)})}function u(n,t){console.log("Dynamics.Crm.ScriptManager.loadStylesheet: "+n);var r=i.filter(function(t){return t===n});r.length===0&&(jQuery("head",t).append("<link rel='stylesheet' href='{path}' />".replace("{path}",n)),i.push(n))}var t={},i=[];n.loadScripts=f;n.loadScript=r;n.loadStylesheets=e;n.loadStylesheet=u})(t=n.ScriptManager||(n.ScriptManager={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(t){var i;(function(i){"use strict";function r(i,r,u){var f,e,o;if(u===void 0&&(u=!0),f=t.Tabs.get(i,u),!f)return null;if(e=f.sections.get(r),e)return e;if(o="The specified section could not be found: "+i+" - "+r,u)throw new Error(o);return n.Diagnostics.log.Message(o),null}i.get=r})(i=t.Sections||(t.Sections={}))})(t=n.Forms||(n.Forms={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(t){var i;(function(t){"use strict";function i(t,i){var r,u;if(i===void 0&&(i=!0),r=Xrm.Page.ui.tabs.get(t),r)return r;if(u="The specified tab could not be found: "+t,i)throw new Error(u);return n.Diagnostics.log.Message(u),null}function f(n,t){t===void 0&&(t=!0);t&&r(n,!0)}function e(n,t){t===void 0&&(t=!0);t&&r(n,!1)}function r(t,r){var u,f;if(n.Diagnostics.trace&&n.Diagnostics.printArguments("Tabs.setVisible",t,r),Array.isArray(t))for(u=0;u<t.length;u++)f=i(t[u],!1),f&&f.setVisible(r);else console.warn("Tabs.setVisible: Invalid argument. An array was expected.")}function o(n,t){t===void 0&&(t=!0);t&&u(n,!0)}function s(n,t){t===void 0&&(t=!0);t&&u(n,!1)}function u(t,r){var u,f;if(n.Diagnostics.trace&&n.Diagnostics.printArguments("Tabs.expandCollapse",t,r),Array.isArray(t))for(u=0;u<t.length;u++)f=i(t[u],!1),f&&f.setDisplayState(r?"expanded":"collapsed");else console.warn("Tabs.expandCollapse: Invalid argument. An array was expected.")}t.get=i;t.show=f;t.hide=e;t.setVisible=r;t.expand=o;t.collpase=s;t.expandCollapse=u})(i=t.Tabs||(t.Tabs={}))})(t=n.Forms||(n.Forms={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={}));