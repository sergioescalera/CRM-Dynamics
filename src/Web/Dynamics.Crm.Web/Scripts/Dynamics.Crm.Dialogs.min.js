"use strict";var Dynamics;(function(n){var t;(function(n){var t;(function(t){function r(){if(!i)throw new Error("Dialog provider hasn't been initialized");return i}function f(n,t){return new Promise(function(i,u){r().Alert(n,t).then(function(n){return n.Show().then(function(){i();n.Destroy()}).catch(function(){u();n.Destroy()})}).catch(function(){return u()})})}function e(n,t){return new Promise(function(i,u){r().Confirm(n,t).then(function(n){return n.Show().then(function(){i(!0);n.Destroy()}).catch(function(){u();n.Destroy()})}).catch(function(){return u()})})}function o(n){return new Promise(function(t,i){r().Create(n).then(function(r){r.Show().then(function(){var i=n.Done();t(i);r.Destroy()}).catch(function(){i();r.Destroy()})}).catch(function(){return i()})})}function s(r){var u=window.top;r=r||n.Publishers.bootstrap;i=t.bootstrapEnabled?new t.BootstrapDialogProvider(u,r):new t.CrmDialogProvider}var u,i;(function(n){n[n.Alert=0]="Alert";n[n.Confirm=1]="Confirm";n[n.Custom=2]="Custom"})(u=t.DialogType||(t.DialogType={}));t.alert=f;t.confirm=e;t.create=o;t.bootstrapEnabled=!0;t.init=s})(t=n.Dialogs||(n.Dialogs={}))})(t=n.Crm||(n.Crm={}))})(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(t){var r=function(){function n(){}return n.alert=function(n,t){return"\n            <div class='modal fade' tabindex='-1' role='dialog'>\n            <div class='modal-dialog' role='document'>\n               <div class='modal-content'>\n                   <div class='modal-header'>\n                       <button type='button' class='close' data-dismiss='modal' aria-label='Close'>\n                           <span aria-hidden='true' >&times;<\/span><\/button>\n                       <h4 class='modal-title'>"+t+"<\/h4>\n                   <\/div>\n                   <div class='modal-body'>"+n+"<\/div>\n                   <div class='modal-footer'>\n                       <button type='button' class='btn btn-primary' data-dismiss='modal'>OK<\/button>\n                   <\/div>\n               <\/div>\n            <\/div>\n            <\/div>"},n.confirm=function(n,t){return"\n            <div class='modal fade' tabindex='-1' role='dialog'>\n            <div class='modal-dialog' role='document'>\n               <div class='modal-content'>\n                   <div class='modal-header'>\n                       <button type='button' class='close' data-dismiss='modal' aria-label='Close'>\n                           <span aria-hidden='true' >&times;<\/span><\/button>\n                       <h4 class='modal-title'>"+t+"<\/h4>\n                   <\/div>\n                   <div class='modal-body'>"+n+"<\/div>\n                   <div class='modal-footer'>\n                       <button type='button' class='btn btn-primary' data-dismiss='modal'>OK<\/button>\n                       <button type='button' class='btn btn-default' data-dismiss='modal'>Close<\/button>\n                   <\/div>\n               <\/div>\n            <\/div>\n            <\/div>"},n}(),i=function(){function n(n,t,i){this._content=t;this._window=n;this._init=i}return n.prototype.Resolve=function(){var n=this._resolve;n&&n()},n.prototype.Reject=function(){var n=this._reject;n&&n()},n.prototype.Show=function(){return this.dialog.modal("show"),this.promise},n.prototype.Destroy=function(){var n=this._dialog;n&&n.remove()},Object.defineProperty(n.prototype,"dialog",{get:function(){return this._dialog||(this._dialog=this._window.$(this._content),this._dialog.appendTo(this._window.$("body")),this._dialog.modal({backdrop:!1,show:!1}),this._window.$("button.btn-primary",this._dialog).click(this.Resolve.bind(this)),this._window.$("button.close",this._dialog).click(this.Reject.bind(this)),this._window.$("button.btn-default",this._dialog).click(this.Reject.bind(this)),this._init&&this._init(this._dialog)),this._dialog},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"promise",{get:function(){var n=this;return this._promise||(this._promise=new Promise(function(t,i){n._resolve=t;n._reject=i})),this._promise},enumerable:!0,configurable:!0}),n}(),u;t.BootstrapDialog=i;u=function(){function t(n,t){this._window=n;this.Init(t)}return t.prototype.Init=function(t){var i="../WebResources/"+t+"_/Libs/bootstrap/";this._loading=n.ScriptManager.loadScript(i+"js/bootstrap.min.js",this._window);n.ScriptManager.loadStylesheet(i+"css/bootstrap.min.css",this._window)},t.prototype.Alert=function(n,t){var u=this;return this._loading.then(function(){return new i(u._window,r.alert(n,t))})},t.prototype.Confirm=function(n,t){var u=this;return this._loading.then(function(){return new i(u._window,r.confirm(n,t))})},t.prototype.Create=function(n){var t=this;return this._loading.then(function(){return new i(t._window,n.Template,n.Init)})},t}();t.BootstrapDialogProvider=u})(t=n.Dialogs||(n.Dialogs={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(n){var i=function(){function n(n){this._message=n}return n.prototype.Show=function(){var n=this;return new Promise(function(t){Xrm.Navigation.openAlertDialog({confirmButtonLabel:"Ok",text:n._message}).then(function(){return t()})})},n.prototype.Destroy=function(){},n}(),t,r;n.CrmAlertDialog=i;t=function(){function n(n,t){this._message=n;this._title=t}return n.prototype.Show=function(){var n=this;return new Promise(function(t,i){Xrm.Navigation.openConfirmDialog({text:n._message,title:n._title}).then(function(){t(!0)},function(){i()})})},n.prototype.Destroy=function(){},n}();n.CrmConfirmDialog=t;r=function(){function n(){}return n.prototype.Alert=function(n){return Promise.resolve(new i(n))},n.prototype.Confirm=function(n,i){return Promise.resolve(new t(n,i))},n.prototype.Create=function(){throw Error("Not supported.");},n}();n.CrmDialogProvider=r})(t=n.Dialogs||(n.Dialogs={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={}));