var Dynamics;Dynamics.Crm.Diagnostics.useConsoleLogger(),function(n){var t;(function(n){var t;(function(n){var t;(function(n){"use strict";var r=function(){function n(){this.ageAttribute=new t;this.attributes={age:this.ageAttribute};this.mainTab=new i;this.tabs={mainTab:this.mainTab};this.ui={tabs:{get:this.getTab.bind(this)}}}return n.prototype.getTab=function(n){return typeof n=="string"?this.tabs[n]:null},n.prototype.getAttribute=function(n){return this.attributes[n]},n}(),t,i;n.PageMock=r;t=function(){function n(){}return n}();n.AttributeMock=t;i=function(){function n(){}return n.prototype.getVisible=function(){return this._visible},n.prototype.setVisible=function(n){this._visible=n},n.prototype.getDisplayState=function(){return this._displayState},n.prototype.setDisplayState=function(n){this._displayState=n},n}();n.TabMock=i})(t=n.Mocks||(n.Mocks={}))})(t=n.UnitTests||(n.UnitTests={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(t){"use strict";describe("Attributes.get",function(){beforeEach(function(){window.Xrm={Page:new t.Mocks.PageMock}});afterEach(function(){window.Xrm=undefined});it("Returns null for missing attribute when not required",function(){var t=n.Forms.Attributes.get("notAge",!1);expect(t).toBeNull()});it("Throws error for missing attribute when required",function(){expect(function(){return n.Forms.Tabs.get("notAge",!0)}).toThrowError(Error)});it("Throws error for missing attribute when required by default",function(){expect(function(){return n.Forms.Tabs.get("notAge")}).toThrowError(Error)})})})(t=n.UnitTests||(n.UnitTests={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(n){var t;(function(t){"use strict";describe("Tabs.get",function(){beforeEach(function(){window.Xrm={Page:new t.Mocks.PageMock}});afterEach(function(){window.Xrm=undefined});it("Returns null for missing tab when not required",function(){var t=n.Forms.Tabs.get("invalidTab",!1);expect(t).toBeNull()});it("Throws error for missing tab when required",function(){expect(function(){return n.Forms.Tabs.get("invalidTab",!0)}).toThrowError(Error)});it("Throws error for missing tab when required by default",function(){expect(function(){return n.Forms.Tabs.get("invalidTab")}).toThrowError(Error)});it("Returns existing tab",function(){var t=n.Forms.Tabs.get("mainTab");expect(t).toBeDefined();expect(t).not.toBeNull()})});describe("Tabs.setVisible",function(){beforeEach(function(){window.Xrm={Page:new t.Mocks.PageMock}});afterEach(function(){window.Xrm=undefined});it("Does not throw error for missing tab",function(){var t=window.Xrm.Page.mainTab;expect(function(){return n.Forms.Tabs.show(["invalidTab"])}).not.toThrowError();expect(function(){return n.Forms.Tabs.hide(["invalidTab"])}).not.toThrowError()});it("Sets tab visibility to true",function(){var t=window.Xrm.Page.mainTab;n.Forms.Tabs.hide(["mainTab"]);n.Forms.Tabs.show(["mainTab"]);expect(t.getVisible()).toBe(!0);n.Forms.Tabs.hide(["mainTab"]);n.Forms.Tabs.show(["mainTab"],!0);expect(t.getVisible()).toBe(!0)});it("Sets tab visibility to false",function(){var t=window.Xrm.Page.mainTab;n.Forms.Tabs.show(["mainTab"]);n.Forms.Tabs.hide(["mainTab"]);expect(t.getVisible()).toBe(!1);n.Forms.Tabs.show(["mainTab"]);n.Forms.Tabs.hide(["mainTab"],!0);expect(t.getVisible()).toBe(!1)});it("Does not change tab visibility when condition is not satisfied",function(){var t=window.Xrm.Page.mainTab;n.Forms.Tabs.hide(["mainTab"]);n.Forms.Tabs.show(["mainTab"],!1);expect(t.getVisible()).toBe(!1);n.Forms.Tabs.show(["mainTab"]);n.Forms.Tabs.hide(["mainTab"],!1);expect(t.getVisible()).toBe(!0)})});describe("Tabs.collapseExpand",function(){beforeEach(function(){window.Xrm={Page:new t.Mocks.PageMock}});afterEach(function(){window.Xrm=undefined});it("Does not throw error for missing tab",function(){var t=window.Xrm.Page.mainTab;expect(function(){return n.Forms.Tabs.expand(["invalidTab"])}).not.toThrowError();expect(function(){return n.Forms.Tabs.collpase(["invalidTab"])}).not.toThrowError()});it("Sets tab to be expanded",function(){var t=window.Xrm.Page.mainTab;n.Forms.Tabs.collpase(["mainTab"]);n.Forms.Tabs.expand(["mainTab"]);expect(t.getDisplayState()).toBe("expanded");n.Forms.Tabs.collpase(["mainTab"]);n.Forms.Tabs.expand(["mainTab"],!0);expect(t.getDisplayState()).toBe("expanded")});it("Sets tab to be collapsed",function(){var t=window.Xrm.Page.mainTab;n.Forms.Tabs.expand(["mainTab"]);n.Forms.Tabs.collpase(["mainTab"]);expect(t.getDisplayState()).toBe("collapsed");n.Forms.Tabs.expand(["mainTab"]);n.Forms.Tabs.collpase(["mainTab"],!0);expect(t.getDisplayState()).toBe("collapsed")});it("Does not change tab state when condition is not satisfied",function(){var t=window.Xrm.Page.mainTab;n.Forms.Tabs.expand(["mainTab"]);n.Forms.Tabs.collpase(["mainTab"],!1);expect(t.getDisplayState()).toBe("expanded");n.Forms.Tabs.collpase(["mainTab"]);n.Forms.Tabs.expand(["mainTab"],!1);expect(t.getDisplayState()).toBe("collapsed")})})})(t=n.UnitTests||(n.UnitTests={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={})),function(n){var t;(function(t){var i;(function(){"use strict";describe("Tasks.execute",function(){it("Returns empty array with null tasks",function(){var t=n.Crm.Tasks.execute(null);expect(t).not.toBeNull();expect(t.length).toEqual(0)});it("Returns empty array with undefined tasks",function(){var t=n.Crm.Tasks.execute(undefined);expect(t).not.toBeNull();expect(t.length).toEqual(0)});it("Force execute on all tasks",function(){var t=0,i=[function(){return t++,!1},function(){t++},function(){return t++,!0},function(){t++;throw new Error("Dummy error");},function(){return t++,!1}],r=n.Crm.Tasks.execute(i,{executeAll:!0,continueOnError:!0});expect(r).not.toBeNull();expect(r.length).toEqual(i.length);expect(t).toEqual(i.length)});it("Stops on third tasks",function(){var t=0,r=[function(){return t++,!1},function(){t++},function(){return t++,!0},function(){return t++,!1}],i=n.Crm.Tasks.execute(r);expect(i).not.toBeNull();expect(i.length).toEqual(3);expect(t).toEqual(3)});it("Stops on first error",function(){var t=0,r=[function(){return t++,!1},function(){t++;throw new Error("Dummy error");},function(){return t++,!1}],i=n.Crm.Tasks.execute(r);expect(i).not.toBeNull();expect(i.length).toEqual(2);expect(t).toEqual(2)})})})(i=t.UnitTests||(t.UnitTests={}))})(t=n.Crm||(n.Crm={}))}(Dynamics||(Dynamics={}));